FROM ubuntu:18.04
RUN apt-get update
RUN apt-get install -y gcc 
RUN apt-get install -y make
 
COPY zlib-1.2.11.tar.gz /tmp/zlib-1.2.11.tar.gz
COPY openssl-1.0.1e.tar.gz /tmp/openssl-1.0.1e.tar.gz
COPY openssh-7.2p1.tar.gz /tmp/openssh-7.2p1.tar.gz

RUN cd /tmp && tar zxvf /tmp/zlib-1.2.11.tar.gz && tar zxvf /tmp/openssl-1.0.1e.tar.gz && tar zxvf /tmp/openssh-7.2p1.tar.gz 

RUN cd /tmp/zlib-1.2.11 && ./configure --prefix=/opt/openssh/dist/ && make && make install
RUN cd /tmp/openssl-1.0.1e && ./config --prefix=/opt/openssh/dist/ && make && make install

RUN groupadd -g 35 sshd
RUN useradd -u 35 -g 35 -c sshd -d / sshd

RUN cd /tmp/openssh-7.2p1 && ./configure --prefix=/opt/openssh/dist/ --with-zlib=/opt/openssh/dist --with-ssl-dir=/opt/openssh/dist/ && make && make install 

RUN groupadd -g 2000 group_bsb17 && useradd -m -u 2001 -g group_bsb17 tpurves && useradd -m -u 2002 -g group_bsb17 sspencer && useradd -m -u 2003 -g group_bsb17 ckirkman && useradd -m -u 2004 -g group_bsb17 jskeen && useradd -m -u 2005 -g group_bsb17 ddecloss


RUN echo "tpurves:trustno1" | chpasswd
RUN echo "sspencer:aked4htijgwaoeihjgigwoeihgo8eiwghowhoeowjskgajsgjhhgoigawegwggjskhgaksjdhgushgkjsdhglgighohgoweioegh" | chpasswd
RUN echo "ckirkman:skgkasfgjksdhgjkgjnh;aikjgkljglkshjg;sdhglkdsjklgldhdhsglkdadslkghsahdkshklsdaldsldglsagklsdgldsgkls" | chpasswd
RUN echo "jskeen:sdkjas;glksdghdsjghsjkdlahgsdkhgklsahgjsdahdjshgjhsdgjksdgkhjsdagfhjskdhdghjskahkhjsfdhgfkhjaddghjakgf" | chpasswd
RUN echo "ddecloss:jghasfhjgsdkfhjagsfhjgsdahjgfjhgfhasgfhjsdgfhjasdgfhjsadgfkgafhadjgashashjdshjsdghjdfsjsdjksadgfdshj" | chpasswd

RUN touch /var/log/auth.log
COPY key /opt/key
RUN chmod 444 /opt/key
COPY start.sh /tmp/start.sh
COPY sshd_config /opt/openssh/dist/etc/sshd_config
COPY sshd_banner /opt/openssh/dist/etc/sshd_banner

ENTRYPOINT "/tmp/start.sh"

EXPOSE 22
